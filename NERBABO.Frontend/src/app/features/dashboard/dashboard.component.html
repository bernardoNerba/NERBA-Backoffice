<div class="container-fluid">
  <div class="row align-items-center">
    <div class="col-8">
      <h3 class="text-truncate mb-2">
        {{ title }}
      </h3>
    </div>
  </div>
</div>
<div class="container-fluid p-1">
  <div class="row g-3 mb-4">
    <!-- KPI Cards Section -->
    <div class="col-12 col-sm-12 col-md-12 col-lg-6">
      <div class="d-flex flex-column h-100 gap-2">
        <div class="flex-grow-1">
          <app-kpi-card
            title="Pagamento Formadores (este mês)"
            [value]="teacherPaymentsValue + '€'"
            icon="pi pi-users"
          />
        </div>
        <div class="flex-grow-1">
          <app-kpi-card
            title="Pagamento Formandos (este mês)"
            [value]="studentPaymentsValue + '€'"
            icon="pi pi-graduation-cap"
          />
        </div>
        <div class="flex-grow-1">
          <app-kpi-card
            title="Total de Empresas (2025)"
            [value]="totalCompaniesValue"
            icon="pi pi-building"
          />
        </div>
      </div>
    </div>

    <!-- Top 5 Tabbed Card (Empresas, Ações, Formandos) -->
    <div class="col-12 col-sm-12 col-md-12 col-lg-6">
      <div class="card shadow border h-100 d-flex flex-column">
        <div class="card-body d-flex flex-column p-3" style="overflow: hidden;">
          <p-tabs value="0" styleClass="h-100 d-flex flex-column">
            <p-tablist>
              @for (tab of tabs; track tab.value) {
              <p-tab [value]="tab.value">{{ tab.title }}</p-tab>
              }
            </p-tablist>
            <p-tabpanels styleClass="flex-grow-1" style="overflow: hidden;">
              @for (tab of tabs; track tab.value) {
              <p-tabpanel [value]="tab.value" styleClass="h-100">
                <div class="list-group list-group-flush" style="max-height: 100%; overflow-y: auto; overflow-x: hidden; padding-right: 4px;">
                  @for (item of tab.content; track item.name) {
                  <div
                    class="d-flex justify-content-between align-items-center py-2 border-bottom"
                  >
                    <span class="text-truncate me-2">{{ item.name }}</span>
                    <p-tag severity="primary" value="{{ item.count }}" />
                  </div>
                  }
                </div>
              </p-tabpanel>
              }
            </p-tabpanels>
          </p-tabs>
        </div>
      </div>
    </div>

    <!-- Line Chart - Students by Education Level -->
    <div class="col-12 col-lg-12">
      <div class="card shadow border" style="height: 250px">
        <div class="card-body d-flex flex-column h-100">
          <app-year-students-education-lvl-chart
            class="flex-grow-1 d-flex flex-column"
            [chartData]="studentsByHabilitationData"
          />
        </div>
      </div>
    </div>

    <!-- Doughnut Chart - Student Results -->
    <div class="col-12 col-lg-6">
      <div class="card shadow border" style="height: 420px">
        <div class="card-body d-flex flex-column h-100">
          <app-year-students-result-chart
            class="flex-grow-1 d-flex flex-column"
            [chartData]="studentResultsData"
          />
        </div>
      </div>
    </div>

    <!-- Doughnut Chart - Actions by Level -->
    <div class="col-12 col-lg-6">
      <div class="card shadow border" style="height: 420px">
        <div class="card-body d-flex flex-column h-100">
          <app-total-action-lvl-chart
            class="flex-grow-1 d-flex flex-column"
            [chartData]="actionHabilitationsData"
          />
        </div>
      </div>
    </div>

    <!-- Bar Chart - Students by Sex -->
    <div class="col-12 col-lg-12">
      <div class="card shadow border" style="height: 250px">
        <div class="card-body d-flex flex-column h-100">
          <app-year-students-sex-chart
            class="flex-grow-1 d-flex flex-column"
            [chartData]="studentGendersData"
          />
        </div>
      </div>
    </div>
  </div>
</div>
